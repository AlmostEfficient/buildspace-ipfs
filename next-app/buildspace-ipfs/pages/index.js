import Head from 'next/head'
import React, { useState, useEffect} from "react";
import CreateItem from '../components/CreateItem'
import Item from '../components/Item';
import styles from '../styles/Home.module.css'

// Constants
const TWITTER_HANDLE = "_buildspace";
const TWITTER_LINK = `https://twitter.com/${TWITTER_HANDLE}`;

export default function Home() {
  const [items, setItems] = useState([]);
  const [creating, setCreating] = useState(false);
  const [viewItems, setViewItems] = useState(false);

  useEffect(() => {
    fetch(`/api/fetchItems`)
      .then(response => response.json())
      .then(data => {
      setItems(data);
      console.log("Products", data);
    });
    
  }, []);

  const renderItemContainer = () => (
    <div className="products-container">
      {items.map((item) => (
        <Item key={item.id} item={item} />
      ))}
    </div>
  );

  return (
    <div className={styles.container}>
      <Head>
        <title>Buildspace IPFS Beam-Up</title>
        <meta name="description" content="Generated by @_buildspace" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <header className="header-container">
        <button className="create-product-button" onClick={() => setCreating(!creating)}>
          {creating ? "Back" : "Create Product"}
        </button>
        <button className="create-product-button" onClick={() => setViewItems(!viewItems)}>
          {viewItems ? "Back" : "View Items"}
        </button>
      </header>

      <main className={styles.main}>
        {creating && <CreateItem />}
        {viewItems && renderItemContainer()}
      </main>

      <div className="footer-container">
          <img alt="Twitter Logo" className="twitter-logo" src="twitter-logo.svg" />
          <a
            className="footer-text"
            href={TWITTER_LINK}
            target="_blank"
            rel="noreferrer"
          >{`built on @${TWITTER_HANDLE}`}</a>
        </div>
    </div>
  )
}
